# 텔레그램 봇 설정 템플릿
# 이 파일을 복사하여 .env 파일을 생성하세요: copy .env.example .env

# TELEGRAM_BOT_TOKEN: BotFather에서 발급받은 봇 토큰(필수)
TELEGRAM_BOT_TOKEN=REPLACE_WITH_TELEGRAM_BOT_TOKEN

# TELEGRAM_ALLOWED_USERS: 이 봇 사용을 허용할 Telegram 사용자 ID 목록(쉼표 구분, 필수)
TELEGRAM_ALLOWED_USERS=REPLACE_WITH_ALLOWED_USER_IDS

# SONOLBOT_ALLOWED_SKILLS: 로드 가능한 스킬 allowlist(쉼표/공백 구분)
# 기본값: sonolbot-telegram,sonolbot-tasks
SONOLBOT_ALLOWED_SKILLS=sonolbot-telegram,sonolbot-tasks

# TELEGRAM_POLLING_INTERVAL: Telegram getUpdates long-poll timeout(초)
# 값이 낮을수록 신규 메시지 반영이 빠르고, 높을수록 네트워크 호출 횟수가 줄어듭니다.
# 기본값: 1
TELEGRAM_POLLING_INTERVAL=1

# TELEGRAM_API_TIMEOUT_SEC: Telegram API 단건 요청 타임아웃(초)
# 기본값: 20
TELEGRAM_API_TIMEOUT_SEC=20

# TELEGRAM_MAX_FILE_BYTES: 다운로드/처리할 텔레그램 첨부파일 최대 크기(바이트)
# 기본값: 52428800 (50MB)
TELEGRAM_MAX_FILE_BYTES=52428800

# TELEGRAM_MESSAGE_RETENTION_DAYS: telegram_messages.json 메시지 보관 기간(일)
# 기본값: 7
TELEGRAM_MESSAGE_RETENTION_DAYS=7

# TELEGRAM_USER_ID: (선택) 운영자/주 사용자 ID
TELEGRAM_USER_ID=REPLACE_WITH_TELEGRAM_USER_ID

# 24시간 대화 컨텍스트 포함 여부 (0=제외, 1=포함) - 기본값: 1
# 0으로 설정하면 이전 대화 내역 없이 새 메시지만 처리
TELEGRAM_INCLUDE_24H_CONTEXT=1

# ---- 경로 설정 (선택) ----
# 전체 TASKS 기본 경로 (기본값: 프로젝트/tasks)
TASKS_DIR=tasks

# 전체 LOGS 기본 경로 (기본값: 프로젝트/logs)
LOGS_DIR=logs

# Telegram 스킬 전용 경로 오버라이드 (미설정 시 LOGS_DIR/TASKS_DIR 사용)
# TELEGRAM_TASKS_DIR=tasks
# TELEGRAM_LOGS_DIR=logs

# Task 스킬 전용 로그 경로 오버라이드 (미설정 시 LOGS_DIR 사용)
# TASKS_LOGS_DIR=logs

# ---- 데몬 설정 (선택) ----
# 폴링 주기(초): 새 메시지 확인 간격
# DAEMON_POLL_INTERVAL_SEC=1

# 유휴 타임아웃(초): app-server 작업 흔적이 이 시간 이상 없으면 워커 정리 대상
# DAEMON_IDLE_TIMEOUT_SEC=600

# 활동 로그(codex-app-server.log) 로테이션 최대 크기(바이트), 기본 10MB
# DAEMON_ACTIVITY_MAX_BYTES=10485760

# 활동 로그 백업 개수, 기본 7 (0이면 백업 비활성화)
# DAEMON_ACTIVITY_BACKUP_COUNT=7

# 활동 로그 보관일(일), 기본 LOG_RETENTION_DAYS와 동일
# DAEMON_ACTIVITY_RETENTION_DAYS=7

# GUI 세션이 없으면 Codex 시작 차단 (브라우저 작업 안전 모드)
# 1=차단, 0=허용
# DAEMON_REQUIRE_GUI_SESSION=0

# 로그 보관 기간(일): logs/*.log 정리 기준
# LOG_RETENTION_DAYS=7

# 활동 감시 로그 파일(기본: logs/codex-app-server.log)
# DAEMON_ACTIVITY_FILE=logs/codex-app-server.log

# ---- 텔레그램 메시지 파싱/스타일 ----
# 텔레그램 parse_mode 강제 사용 여부 (1=강제, 0=호출부 지정값만 사용)
DAEMON_TELEGRAM_FORCE_PARSE_MODE=1

# 기본 parse_mode (HTML/MarkdownV2/Markdown)
DAEMON_TELEGRAM_DEFAULT_PARSE_MODE=HTML

# parse_mode 전송 실패 시 같은 본문을 parse_mode 없이 1회 재시도 (1=재시도, 0=미재시도)
DAEMON_TELEGRAM_PARSE_FALLBACK_RAW_ON_FAIL=1

# ---- Agent Message Rewriter 설정 ----
# 중간 agent_message를 사용자 친화 문장으로 재작성 (1=사용, 0=미사용)
DAEMON_AGENT_REWRITER_ENABLED=1

# rewriter 코덱스 모델 (기본: gpt-5.3-codex, 필요시 패널에서 변경)
DAEMON_AGENT_REWRITER_MODEL=gpt-5.3-codex

# rewriter 임시 작업폴더 루트 (봇별 하위 폴더 자동 생성)
DAEMON_AGENT_REWRITER_TMP_ROOT=/tmp/sonolbot-agent-rewriter

# app-server 중지/종료 시 tmp rewriter 작업폴더 자동 정리 (1=정리, 0=유지)
DAEMON_AGENT_REWRITER_CLEANUP_TMP=1

# rewriter 추론 강도 (none/minimal/low/medium/high/xhigh)
# 기본값은 가장 빠른 none
DAEMON_AGENT_REWRITER_REASONING_EFFORT=none

# rewriter turn 완료 대기 시간(초)
DAEMON_AGENT_REWRITER_TIMEOUT_SEC=40

# rewriter app-server 요청 타임아웃(초)
DAEMON_AGENT_REWRITER_REQUEST_TIMEOUT_SEC=30

# rewriter 재시도 횟수 (0이면 재시도 없음)
DAEMON_AGENT_REWRITER_MAX_RETRY=1

# rewriter 재시작 백오프(초)
DAEMON_AGENT_REWRITER_RESTART_BACKOFF_SEC=2

# 각 task에 코덱스 런 세션 메타(run_id/mode/started_at/session_id 등) 기록
# 기본값: 1 (끄려면 0)
SONOLBOT_STORE_CODEX_SESSION=1
